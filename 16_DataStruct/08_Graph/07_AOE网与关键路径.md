
### AOE 网

- AOE 网是一个带权的有向无环图。其中，用顶点表示事件，弧表示活动，权值表示活动持续的时间。AOE 网是以边表示活动的网。
- 在 AOE 网中，通过研究事件与活动之间的关系，从而可以确定整个工程的最短完成时间，明确活动之间的相互影响，确保整个工程的顺利进行。
- 在顶点表示事件发生之后，从该顶点出发的有向弧所表示的活动才能开始。在进入某个顶点的有向弧所表示的活动完成之后，该顶点表示的事件才能发生。
- 对于一个工程来说，只有一个开始状态和一个结束状态，因此，在 AOE 网中，只有一个入度为 0 的点表示工程的开始，称为`源点`。只有一个出度为 0 的点表示工程的结束，称为`汇点`。


### 关键路径

- `关键路径是指在 AOE 网中从源点到汇点路径最长的路径`。这里的路径是指路径上各个活动持续时间之和。
- 在 AOE 网中，有些活动是可以并行执行的，`关键路径其实就是完成工程的最短时间所经过的路径`。
- 关键路径上的活动称为`关键活动`。
- 非关键活动提前完成或推迟完成并不会影响到整个工程的进度。


### 关键路径的相关概念

```shell
  ve: vertex early
  vl: vertex lately
  dut: 活动的持续时间，也即边的权值
  ee: edge early
  el: edge early
```

- 事件 vi 的最早发生时间

从源点到顶点 vi 的最长路径长度，称为事件 vi 的最早发生时间，记作 ve(i)。求解 ve(i) 可以从源点 ve(0)=0 开始，按照拓扑排序规则根据递推得到:
```shell
  ve(i) = Max{ve(k)+dut(<k,i>) | <k,i>∈T,1<=i<=n-1}
```
其中，T 是所有以第 i 个顶点为弧头的弧的集合，dut(<k,i>) 表示弧 <k,i> 对应的活动的持续时间。

- 事件 vi 的最晚发生时间

在保证整个工程完成的前提下，活动必须最迟的开始时间，记作 vl(i)。在求解事件 vi 的最早发生时间 ve(i) 的前提 vl(n-1)=ve(n-1) 下，从汇点开始，向源点推进得到 vl(i):
```shell
  vl(i) = Min{vl(k)-dut(<i,k>) | <i,k>∈S,0<=i<=n-2}
```
其中，S 是所有以第 i 个顶点为弧尾的弧的集合，dut(<i,k>) 表示弧 <i,k> 对应的活动的持续时间。

- 活动 ai 的最早开始时间 ee(i)

如果弧 <vk,vj> 表示活动 ai, 当事件 vk 发生之后，活动 ai 才开始。因此，事件 vk 的最早发生时间也就是活动 ai 的最早开始时间，即 ee(i)=ve(k) 。

- 活动 ai 的最晚开始时间 el(i)

在不推迟整个工程完成时间的基础上，活动 ai 最迟必须开始的时间。如果弧 <vk,vj> 表示活动 ai, 持续时间为 dut(<k,j>)，则活动 ai 的最晚开始时间 el(i)=vl(j)-dut(<k,j>)。

- 活动 ai 的松弛时间

活动 ai 的最晚开始时间与最早开始时间之差，就是活动 ai 的松弛时间，记叙 el(i)-ee(i) 。


### AOE 网求关键路径算法

1. 对 AOE 网中的顶点进行拓扑排序，如果得到的拓扑序列顶点个数小于网中顶点数，则说明网中有环存在，不能求关键路径，终止算法。否则，从源点 v0 开始，求出各个顶点的最早发生时间 ve(i)。
2. 从汇点 vn 出发 vl(n-1)=ve(n-1)，按照逆拓扑序列求其他顶点的最晚发生时间 vl(i)。
3. 由各顶点的最早发生时间 ve(i) 和最晚发生时间 vl(i), 求出每个活动 ai 的最早开始时间 ee(i) 和最晚开始时间 el(i) 。
4. 找出所有满足条件 ee(i)=el(i) 的活动 ai, ai 即是关键活动。所有的关键活动构成了关键路径。


### 其他

- 关键路径经过的顶点是满足条件 ve(i)=vl(i)，即当事件的最早发生时间与最晚发生时间相等时，该顶点一定在关键路径之上。
- 关键活动者的弧满足条件 ee(i)=el(i)，即当活动的最早开始时间与最晚开始时间相等时，该活动一定是关键活动。
- 所有的关键事件点无法确定关键路径，但所有的关键活动可以确定关键路径。


### 如何理解逆拓扑排序

- 将原图(必须是有向无环图)进行拓扑排序，并按输出顶点顺序将顶点依次入栈。
- 将顶点与顶点之间的箭头全部打反，打反后的图仍然是一个有向无环图。
- 将栈中顶点依次全部弹出，对照打反后的图会发现，弹出的顶点序列是这个图的一种拓扑排序。