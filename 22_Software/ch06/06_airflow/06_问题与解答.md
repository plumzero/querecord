
### 用于测试的 DAG 未消除

描述:
在配置中将 `load_examples` 设置为 `False` 后，重启 webserver，在页面中仍存在用于测试的 DAG 。

解决:
在 webserver 启动之前重置一下数据库:
```sh
    airflow$ airflow db reset
```


### 新添加的 DAG 未在 web 页面上显示

描述:
将 DAG 文件放置到 `dags_folder` 指定目录下后，刷新 web 页面，并没有显示出来。

解决:
不能总是 reset 数据库啊，把 `scheduler` 进程启动起来就好了。
```sh
    airflow$ airflow scheduler
```


### 启动 `scheduler` 进程时报错

报错如下:
```sh
    psycopg2.errors.InsufficientPrivilege: permission denied for table celery_taskmeta
```

以数据库超级用户 postgres 进入 `celery` 库，为其赋予权限:
```sh
    celery=# GRANT ALL PRIVILEGES ON TABLE celery_taskmeta TO airflower;
    GRANT
```
这个错误一般是不会发生的，除非你用的不是 airflower 用户初始化的数据库。


### 启动 `worker` 进程时报错

报错如下:
```sh
    psycopg2.errors.InsufficientPrivilege: permission denied for sequence task_id_sequence
```

以数据库超级用户 postgres 进入 `celery` 库，为其赋予权限:
```sh
    celery=# GRANT ALL PRIVILEGES ON SEQUENCE task_id_sequence TO airflower;
    GRANT
```
这个错误一般是不会发生的，除非你用的不是 airflower 用户初始化的数据库。


### 替换或修改 DAG 文件

删除、替换或修改 DAG 文件时，最好不要立即删除 `dags_folder` 目录下的文件，而应该采取这样的步骤:
1. 在 web 页面上点击垃圾桶图标(Delete DAG)进行删除
2. 之后再对 `dags_folder` 下的相应文件进行删除、替换或修改

`scheduler` 进程会定时轮询 `dags_folder` 目录，所以一段时间后，刷新页面就可以看到又显示到页面上了。

`scheduler` 的轮询时间可以通过 airflow.cfg 中的 `scheduler.dag_dir_list_interval` 配置项进行修改，默认为 300 秒。


### 关于环境变量 AIRFLOW_HOME

经测试，不需要显式设置到用户配置文件中。总之，不要管它就行了。


### 执行 DAG 文件中任务一直处理 running 状态

是不是没有启动 `worker` 进程~
